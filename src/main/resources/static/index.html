<!DOCTYPE html>
<html lang="en">
<link rel="stylesheet" href="styles.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.1.4/sockjs.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
<script type="text/javascript">
    function setConnected() {
        var connected = document.getElementById('connect');
        username = document.getElementById('from').value;
        setConnection = true;
        if (setConnection) {
            console.log('Connected: ' + username);
            stompClient.subscribe('/chatroom/public', onMessageReceived);
            stompClient.subscribe('/chatroom/greetings', updateConnectedUsers);


            stompClient.send("/app/chat.addUser",
                {},
                JSON.stringify({senderName: username, type: 'JOIN'})
            )
        }



    }
    function connect() {
        var socket = new SockJS('http://localhost:8080/ws');
        stompClient = Stomp.over(socket);
        stompClient.connect({}, setConnected, onError);
        var registerDiv = document.getElementById('register');
        registerDiv.style.visibility = 'hidden';


        var chatroomDivV = document.getElementById('chatroomDiv');
        chatroomDivV.style.visibility = 'visible';

    }
</script>



<head>
    <meta charset="UTF-8">
    <title>Chatroom</title>
</head>
<body>
<div>
    <div class="container">
        <div id="register">
            <div class="vertical-center">
                <h1>Start Page</h1>
                <input type="text" id="from" placeholder="enter your chatUser name"/>
                <button id="connect" onclick="connect();">Connect</button>
            </div>
        </div>
    </div>

    <div id="chatroomDiv" style="visibility:hidden" class="centered">

        <h1>Chatroom</h1>

        <div>
            <div class='chatbox__user-list' id="dvTable">
            </div>

            <div class="box">
                <span id="response"> </span>
                <div class="p.message" id="conversation">
                    <br>
                </div>
            </div>
        </div>
        <div class="vertical-center2">
            <input type="text" id="message" placeholder="enter your message" autocomplete="off" class="form-control">
            <button id="send" onclick="sendMessage();">Send</button>
        </div>

    </div>

        </div>

    </div>
</div>
</body>


</html>
